<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API test</title>
    <!-- get css-styling -->
    <link rel="stylesheet" href="/styles.css" />
</head>
<body>
    <div class="grid-container">
        <nav>
            <div id="welcome">
                <a href="/" class="course"
                    ><h1>Backend och databaser</h1></a
                >
                <p class="student">
                    Laboration 1 - Kristina Palmquist - JSU22
                </p>
            </div>
            <ul>
                <li><a href="/">Home</a></li>
                <li><a href="/chat">Chat</a></li>
                <li><a href="/search">Search</a></li>
                <li><a href="/register">Register</a></li>
                <li><a href="/apitest">API test</a></li>
            </ul>
        </nav>

        <main>
            <div id="titles" class="content">
                <h2>All titles</h2>

            </div>
        </main>

        <footer>
            <p>Copyright &copy; Kristina Palmquist 2023</p>
        </footer>

    <script>
        // GET-request
        const options = {
            method: 'GET',
            headers: {
                'Accept': 'application/json'
            }
        };

        // anropa printCustomerData
        printTitleData();

        async function printTitleData() {
            // anropa getTitles, få tillbaka data
            let data = await getTitles();

            let div = document.querySelector('#titles');
            // skriv ut data
            for (const title of data) {
                // skapa en p-tagg per kund och skriv ut kundens förnamn
                let element = document.createElement('p');
                element.innerText = title.title;
                div.appendChild(element);
                // logga kundobjekten
                console.log(title);
            }
        }

            // hämta data
        async function getTitles() {
            // anropa APIet och invänta svar
            const response = await fetch('http://localhost:5421/title/all', options)
            // logga ev. fel
            .catch(error => {
                console.error(error);
            });
            // gör om svaret till json
            let data = await response.json();
            // returnera data
            return data;
        }

    </script>
</body>
</html>
